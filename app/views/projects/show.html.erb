<%= stylesheet_link_tag 'chart-style.css' %>

<h1><%= @project.name %></h1>

<div class="timer">
    <p class="timer-time"><span id="hours">00</span>:<span id="minutes">00</span>:<span id="seconds">00</span></p>
    <div class="timer-controls">
        <button class="primary-button" id="button-start">Start</button>
        <button class="primary-button" id="button-end">End</button>
        <button hidden id="button-reset">Reset</button>
    </div>
</div>

<div hidden>
    <%= render "sessions/form", session: @session %>
</div>

<%= area_chart [[]],
  class: 'box',
  code: false,
  options: {
    xAxis: {
      type: "time",
      data: []
    },
    yAxis: {
      name: "Cumulative Time (hours)",
      nameLocation: "middle",
      nameGap: 50,
      nameTextStyle: {
        fontSize: 18,
        fontWeight: "bolder"
      }
    },
    series: {
      data: @project.for_line_chart_2[:data],
      markPoint: {
        data: @project.for_line_chart_2[:points],
        symbol: "circle",
        symbolSize: 10
      }
    },
    tooltip: {
      show: true,
      confine: true,
      formatter: RailsCharts.js('(value) => {
        let text = "<b>" + value[0].data[0] + "</b><br>"
        text += "Cumulative Time: " + value[0].data[1].toFixed(2) + " hours"

        if (value[0].data.length > 2) {
          text += "<br><br><b>Milestones:</b>"
          for (let i = 2; i < value[0].data.length; i++) {
            text += "<br><p>" + value[0].data[i] + "</p>"
          }
        }
        return text
      }'),
      className: 'echarts-tooltip echarts-tooltip-dark',
      appendToBody: true
    },
    dataZoom: [{
      start: 0,
      end: 100,
    }],
  }
%>

<%
=begin%>
 <%= calendar_chart @project.for_calendar_chart,
  class: 'box',
  code: false,
  options: {
    visualMap: {
      show: false,
      min: 0,
      max: 40,
      orient: 'horizontal'
    },
    calendar: [{
      range: ['2023-01-01', '2023-05-31'],
      yearLabel: { show: false },
    },]
  }
%> 
<%
=end%>

<%= render "milestones/form", milestone: @milestone %>

<%= javascript_import_module_tag "echarts" %>

<%= javascript_import_module_tag "session-timer" %>